rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Secure access to files by ensuring the user's account ID, stored in their
    // auth token, matches the account ID in the storage path.
    match /accounts/{accountId}/{allPaths=**} {
      allow read, write: if request.auth != null && request.auth.token['accountId'] == accountId;
    }
  }
}
